# ZAP Security Rules for CloudMart
# Format: IGNORE|WARN|FAIL	RULE_ID	URL_REGEX	PARAMETER	CWE	WASCID	DESCRIPTION

# Ignore false positives for static assets
IGNORE	10021	.*\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$		79	15	X-Frame-Options Header Not Set

# Warn on missing security headers but don't fail build
WARN	10016	.*		16	14	Web Browser XSS Protection Not Enabled
WARN	10017	.*		16	14	Cross-Domain JavaScript Source File Inclusion
WARN	10019	.*		16	14	Content-Type Header Missing

# Fail on critical security issues
FAIL	40018	.*		89	13	SQL Injection
FAIL	40019	.*		89	19	SQL Injection - MySQL
FAIL	40020	.*		89	19	SQL Injection - Hypersonic SQL
FAIL	40021	.*		89	19	SQL Injection - Oracle
FAIL	40022	.*		89	19	SQL Injection - PostgreSQL
FAIL	40024	.*		89	19	SQL Injection - SQLite
FAIL	90019	.*		352	9	Server Side Code Injection
FAIL	90020	.*		78	20	Remote OS Command Injection
FAIL	40012	.*		79	13	Cross Site Scripting (Reflected)
FAIL	40014	.*		79	13	Cross Site Scripting (Persistent)
FAIL	40016	.*		79	13	Cross Site Scripting (Persistent) - Prime
FAIL	40017	.*		79	13	Cross Site Scripting (Persistent) - Spider

# Authentication and session management
FAIL	10040	.*		287	1	Secure Cookie Flag Not Set
FAIL	10041	.*		614	13	HTTP to HTTPS Insecure Transition in Form Post
FAIL	10042	.*		319	4	HTTPS to HTTP Insecure Transition in Form Post
FAIL	10043	.*		16	13	User Controllable HTML Element Attribute (Potential XSS)

# Information disclosure
WARN	10045	.*		200	13	Source Code Disclosure - /WEB-INF folder
WARN	10048	.*		548	13	Remote Code Execution - Shell Shock
WARN	10049	.*		200	13	Content Cacheability

# API Security
FAIL	90033	.*\/api\/.*		285	2	Loosely Scoped Cookie
FAIL	90034	.*\/api\/.*		16	13	Cloud Metadata Potentially Exposed
