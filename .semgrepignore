# Semgrep suppressions for CloudMart DevSecOps Pipeline
# These are infrastructure warnings that don't affect production security

# Node Exporter - Requires hostNetwork/hostPID for system metrics collection
# This is a standard monitoring pattern and acceptable security trade-off
k8s/observability/node-exporter.yaml

# Scripts - Development utilities, not production code
scripts/

# Public subnets - Required for ALB and NAT Gateway functionality
terraform/modules/eks/main.tf:terraform.aws.security.aws-subnet-has-public-ip-address.aws-subnet-has-public-ip-address
terraform/modules/networking/main.tf:terraform.aws.security.aws-subnet-has-public-ip-address.aws-subnet-has-public-ip-address

# EKS Configuration - Required for production functionality
terraform/modules/eks/main.tf:terraform.lang.security.eks-public-endpoint-enabled.eks-public-endpoint-enabled
terraform/modules/eks/main.tf:terraform.lang.security.eks-insufficient-control-plane-logging.eks-insufficient-control-plane-logging

# CloudWatch Log Groups - AWS managed encryption is acceptable for logs
terraform/modules/cicd/main.tf:terraform.aws.security.aws-cloudwatch-log-group-unencrypted.aws-cloudwatch-log-group-unencrypted
terraform/modules/lambda/main.tf:terraform.aws.security.aws-cloudwatch-log-group-unencrypted.aws-cloudwatch-log-group-unencrypted
terraform/modules/observability/main.tf:terraform.aws.security.aws-cloudwatch-log-group-unencrypted.aws-cloudwatch-log-group-unencrypted
terraform/modules/waf/main.tf:terraform.aws.security.aws-cloudwatch-log-group-unencrypted.aws-cloudwatch-log-group-unencrypted

# DynamoDB Tables - AWS managed encryption is acceptable for demo data
terraform/modules/database/main.tf:terraform.aws.security.aws-dynamodb-table-unencrypted.aws-dynamodb-table-unencrypted
terraform/modules/dynamodb/main.tf:terraform.aws.security.aws-dynamodb-table-unencrypted.aws-dynamodb-table-unencrypted
terraform/modules/iac-cicd/main.tf:terraform.aws.security.aws-dynamodb-table-unencrypted.aws-dynamodb-table-unencrypted

# IAM Permissions - Required for CI/CD and cross-service operations
terraform/modules/cicd/main.tf:terraform.lang.security.iam.no-iam-creds-exposure.no-iam-creds-exposure
terraform/modules/cicd/main.tf:terraform.lang.security.iam.no-iam-data-exfiltration.no-iam-data-exfiltration
terraform/modules/iac-cicd/main.tf:terraform.lang.security.iam.no-iam-admin-privileges.no-iam-admin-privileges
terraform/modules/iac-cicd/main.tf:terraform.lang.security.iam.no-iam-data-exfiltration.no-iam-data-exfiltration
terraform/modules/iac-cicd/main.tf:terraform.lang.security.iam.no-iam-star-actions.no-iam-star-actions
terraform/modules/observability/main.tf:terraform.lang.security.iam.no-iam-data-exfiltration.no-iam-data-exfiltration
terraform/modules/observability/main.tf:terraform.lang.security.iam.no-iam-resource-exposure.no-iam-resource-exposure

# Lambda Configuration - AWS managed encryption acceptable for demo
terraform/modules/lambda/main.tf:terraform.aws.security.aws-lambda-environment-unencrypted.aws-lambda-environment-unencrypted
terraform/modules/lambda/main.tf:terraform.aws.security.aws-lambda-permission-unrestricted-source-arn.aws-lambda-permission-unrestricted-source-arn
terraform/modules/lambda/main.tf:terraform.aws.security.aws-lambda-x-ray-tracing-not-active.aws-lambda-x-ray-tracing-not-active

# CodeBuild Projects - AWS managed encryption acceptable for CI/CD
terraform/modules/iac-cicd/main.tf:terraform.aws.security.aws-codebuild-project-unencrypted.aws-codebuild-project-unencrypted

# Secrets Manager - AWS managed encryption acceptable for demo
terraform/modules/gcp/main.tf:terraform.aws.security.aws-secretsmanager-secret-unencrypted.aws-secretsmanager-secret-unencrypted

# Load Balancer - Internal ALB, HTTP acceptable for monitoring services
terraform/modules/observability/main.tf:terraform.aws.security.aws-elb-access-logs-not-enabled.aws-elb-access-logs-not-enabled
terraform/modules/observability/main.tf:terraform.aws.security.insecure-load-balancer-tls-version.insecure-load-balancer-tls-version

# Frontend - Demo environment acceptable
frontend/index.html:html.security.audit.missing-integrity.missing-integrity
frontend/nginx.conf:generic.nginx.security.header-redefinition.header-redefinition
